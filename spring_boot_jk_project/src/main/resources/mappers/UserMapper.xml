<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="edu.sejong.ex.mapper.UserMapper">
    <select id="getUser" resultType="edu.sejong.ex.vo.UserAuthorityVO">
        <![CDATA[
        	select users.*, authorities.authority 
        	from users, authorities 
        	where users.username = authorities.username and users.username = #{username}
        	order by authorities.authority
        ]]>
    </select>
    
<!--     <insert id="insertIntoBuser">
        <![CDATA[
			insert into buser values (
			    #{buid},
			    #{bupw}
			)
		]]>
    </insert>   
 -->     

    <insert id="insertUser">
        <![CDATA[
			insert into users values (
			    #{username},
			    #{password},
			    1
			)
		]]>
    </insert>    
    <insert id="insertAuthorities">
        <![CDATA[
			insert into authorities values (
			    #{username},
			    'ROLE_USER'
			)
		]]>
    </insert>
    <insert id="insertAuthoritiesAdmin">
        <![CDATA[
			insert into authorities values (
			    #{username},
			    'ROLE_ADMIN'
			)
		]]>
    </insert>
    
    <select id="selectUser" resultType="String">
        <![CDATA[
			select username from users where username = #{username} and password = #{password}
        ]]>
    </select>    
    
</mapper>